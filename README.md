# FERMI QOR

FERMI QOR is a comprehensive system designed to parse log files, record statistics, and display data through APIs. The project involves multiple components including Python scripts for parsing and recording data, a Flask-based API, Docker containerization, and a CI/CD pipeline for automated deployment.

## Table of Contents
1. [Project Description](#project-description)
2. [Directory Structure](#directory-structure)
3. [Installation](#installation)
4. [Usage](#usage)
   - [Parsing Script](#parsing-script)
   - [Recording Script](#recording-script)
   - [API Script](#api-script)
5. [Docker Setup](#docker-setup)
6. [Testing and Automation](#testing-and-automation)
7. [CI/CD Pipeline](#cicd-pipeline)
8. [Code Overview](#code-overview)
9. [Contributing](#contributing)
10. [License](#license)

## Project Description

FERMI QOR provides a seamless solution for processing log files and generating insights through a structured pipeline. The project includes parsing logs into a structured format, recording statistics into a database, and providing access to this data via an API. Additionally, the application is containerized using Docker, and deployment is automated through a CI/CD pipeline.

## Directory Structure

The project structure is organized as follows:

### Explanation of the Structure:
- **`.github/workflows/cicd.yml`**: Configuration file for the CI/CD pipeline, automating the build, test, and deployment processes.
- **`flaskapp/`**: Contains the main application code, including:
  - **`__pycache__/`**: Automatically generated cache files for optimized Python code.
  - **`static/`**: Static files such as CSS
  - **`templates/`**: HTML templates for rendering the front-end.
  - **`app.py`**: The main script running the Flask application.
    - **`docker-compose.yml`**: Defines services, networks, and volumes for Docker containers.
    - **`Dockerfile`**: Instructions for building the Docker image of the Flask application.
    - **`fermi.txt`**: A sample output file generated by the parsing script.
    - **`fermocopy.txt`**: A copy of the `fermi.txt` file with different Job IDs.
    - **`recordingScript.py`**: Script for recording parsed data into the MySQL database.
    - **`requirements.txt`**: Lists the Python dependencies required for the project.
    - **`test.py`**: Contains unit tests for validating the functionality of the application.
- **`dummy_logfile.txt`**: A sample log file used for testing the parsing script.
- **`parsingScript.py`**: Script for parsing log files and generating the `fermi.txt` output.
- **`README.md`**: The README file you're currently reading, which provides an overview of the project.


## Installation

### Prerequisites

- Python 3.8+
- Docker and Docker Compose

### Setup Instructions

1. Clone the repository:
    ```sh
    git clone <repository-url>
    cd QOR-PROJECT
    ```

2. Install the Python dependencies:
    ```sh
    pip install -r requirements.txt
    ```

3. Set up the database:
    - The project uses MySQL as the database. You can either set it up locally or use the Dockerized version (explained in the [Docker Setup](#docker-setup) section).

## Usage

### Parsing Script

The parsing script is used to process log files and generate a structured `fermi.txt` file.

#### Command-line Arguments:

- `-l`: Location of the run.
- `-id`: ID of the run.
- `-p`: Only parse the file and create `fermi.txt` in the directory.
- `-r`: Directory of `rsync`, containing only the `qor` folder.

#### Example Usage:
```sh
python3 parsingScript.py -l /path/to/location -id 12345 -p -r /path/to/rsync
```

### Recording Script
This script records the parsed statistics from fermi.txt into a MySQL database.

#### Command-line Arguments:

- `-f`: Location of the fermi.txt file to be parsed.
#### Example Usage:
```sh
python3 recordingScript.py -f /path/to/location
```
### API Script

The Flask-based API script provides endpoints to display the data stored in the database.

#### Running the API:
```sh
python3 flaskapp/app.py
```
### Docker Setup

To containerize the application and run all components using Docker:

#### Build and run the Docker containers:
```sh
docker compose up --build
```
### Testing and Automation

#### API Testing with Pytest
- Create automated tests for all API endpoints using pytest.
- Set up an automated system to send an html report of test results via email.

#### Running Tests
You can run the test suite using the following command:
```sh
pytest flaskapp/test.py --html=report.htl
```
